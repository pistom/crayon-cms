function Pageconsole(a){if(a=a||{},!(this instanceof Pageconsole))return new Pageconsole(a);this._config=this._extendOptions(a),this._pconWindow=null,this._pconStdIn=null,this._pconStdOut=null,this._createConsoleWindow(),this._addHotKeyToDisplayConsoleWindow(),this._pconStdIn.addEventListener("keyup",this._execute.bind(this),!1),this._history=window.localStorage.history?window.localStorage.getItem("history").split(","):[],this._historyIndex=this._history.length-1,this._aliasses=window.localStorage.aliasses?JSON.parse(window.localStorage.getItem("aliasses")):{},this._commandsList=[];for(var b in this)-1===b.search(/^_/)&&this._commandsList.push(b);this._walk=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode:function(a){return/\w+/.test(a.data)?NodeFilter.FILTER_ACCEPT:void 0}},!1),this._actualNode=document.body.firstChild,this._prevNode=document.body.firstChild,this._selectablesElems=["P","A","H1","H2","H3","H4"],this._isProgramRunning=!1,this.print=this._config.stdOut?this._putStdOut:function(){console.log("Output is disabled.")},this.put=function(a){this._pconStdIn.value=a},this.clear=this._config.stdOut?this._clearStdOut:function(){console.log("Output is disabled.")},this.hide=function(){this._pconWindow.style.display="none"},this.getLine=this._getLine}Pageconsole.prototype._clearStdIn=function(){this._pconStdIn.value=""},Pageconsole.prototype._clearStdOut=function(){for(var a=this._pconStdOut.childNodes.length-1;a>=0;a--)this._pconStdOut.removeChild(this._pconStdOut.childNodes[a])},Pageconsole.prototype._putStdOut=function(a){a=a instanceof Array?a.join("&nbsp;"):a,a='<span style="color:'+this._config.outputTextColor+'">'+a.replace(/<(\/?\w*)>/g,"&lt;$1&gt;").replace(/^ +/g,"&nbsp;")+"</span>",a=a.replace(/(\[\d;\d{2}])/g,function(){var a=[].slice.call(arguments,1,-2);return this._config.outputTextColor=this._colors[a[0]],' </span><span style="color:'+this._colors[a[0]]+'">'}.bind(this));var b=document.createElement("div"),c=""==a?" ":a;for("pageconsole"===this._config.stdOut&&(b.innerHTML=c,this._showHideConsoleWindow()),"navigator"===this._config.stdOut&&console.log(c),this._pconStdOut.appendChild(b);this._pconStdOut.childNodes.length>this._config.maxOutputLines;)this._pconStdOut.removeChild(this._pconStdOut.childNodes[0])},Pageconsole.prototype._execute=function(a){if(13===a.keyCode){var b=this._pconStdIn.value;if(!this._isProgramRunning){this._config.stdOut&&this.print("[1;30]"+b+"[1;37]"),this._clearStdIn();var c=b.split(" "),d=c[0];d in this._aliasses&&(c=this._aliasses[d].split(" "),d=c[0]),c.shift();try{this[d](c)}catch(a){"TypeError"===a.name&&this.print("Command not found"),console.log(a)}}this._history.push(b),this._history.length>15&&this._history.shift(),window.localStorage.setItem("history",this._history),this._historyIndex=this._history.length-1}38===a.keyCode&&this._getCommandFromHistory("prev"),40===a.keyCode&&this._getCommandFromHistory("next")},Pageconsole.prototype._getLine=function(a){var b=null,c=function(a){13===a.keyCode&&(b=this._pconStdIn.value,this.print(b),this._clearStdIn())}.bind(this);this._isProgramRunning=!0,this._pconStdIn.addEventListener("keyup",c,!1);var d=function(){this._pconStdIn.removeEventListener("keyup",c,!1),this._isProgramRunning=!1,a(b)}.bind(this),e=setInterval(function(){null!=b&&(clearInterval(e),d())},500)},Pageconsole.prototype._getCommandFromHistory=function(a){0!==this._history.length&&(this.put(this._history[this._historyIndex]),"prev"===a&&this._historyIndex>0&&this._historyIndex--,"next"===a&&this._historyIndex<this._history.length-1&&this._historyIndex++)},Pageconsole.prototype._extendOptions=function(a){var b=JSON.parse(JSON.stringify(this._defaultConfig));for(var c in b)c in a||(a[c]=b[c]);return a},Pageconsole.prototype._createConsoleWindow=function(){var a=document.createDocumentFragment(),b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("input"),e=document.createElement("div");b.style.display="none",this._config.disableStyles||("left"===this._config.position?b.style.left="5px":b.style.right="5px",b.style.position="fixed",b.style.zIndex="10000",b.style.bottom="5px",b.style.width="300px",b.style.padding="5px",b.boxSizing="border-box",b.style.fontFamily="Courier New,Courier,Lucida Sans Typewriter,Lucida Typewriter,monospace",b.style.fontSize="12px",b.style.background="rgba(0,0,0,.8)",b.style.border="1px solid rgba(255,255,255,.8)",c.style.color="rgb(255,255,255)",c.style.overflow="hidden",d.style.color="rgb(255,255,255)",d.style.border="none",d.style.background="transparent",d.style.display="block",d.style.width="100%"),this._config.domClasses&&(b.classList.add(this._config.domClasses[0]),d.classList.add(this._config.domClasses[1]),c.classList.add(this._config.domClasses[2])),this._config.stdOut&&(this._config.greeting&&(e.appendChild(document.createTextNode(this._config.greeting)),c.appendChild(e)),b.appendChild(c)),b.appendChild(d),a.appendChild(b),document.body.appendChild(a),this._pconWindow=b,this._pconStdIn=d,this._config.stdOut&&(this._pconStdOut=c)},Pageconsole.prototype._showHideConsoleWindow=function(a){if("undefined"!=typeof a&&this._config.hotKey){var b=this._config.hotKey.toLowerCase().split(/ *\+ */),c="esc"===b[b.length-1]?"escape":b[b.length-1],d=-1!=b.indexOf("ctrl"),e=-1!=b.indexOf("shift"),f=-1!=b.indexOf("alt");("esc"===a.key.toLowerCase()&&"escape"===c||a.key.toLowerCase()===c&&a.altKey===f&&a.ctrlKey===d&&a.shiftKey===e)&&(this._pconWindow.style.display="block",this._pconStdIn.focus())}else this._pconWindow.style.display="block"},Pageconsole.prototype._addHotKeyToDisplayConsoleWindow=function(){this._config.hotKey?document.addEventListener("keyup",this._showHideConsoleWindow.bind(this),!1):this._showHideConsoleWindow()},Pageconsole.prototype._colors={"[0;30]":"black","[0;31]":"red","[0;32]":"green","[0;33]":"orange","[0;34]":"blue","[0;35]":"purple","[0;36]":"cyan","[0;37]":"lightgray","[1;30]":"darkgray","[1;31]":"lightred","[1;32]":"lightgreen","[1;33]":"yellow","[1;34]":"lightblue","[1;35]":"mediumpurple","[1;36]":"lightcyan","[1;37]":"white"},Pageconsole.prototype._defaultConfig={hotKey:"Esc",disableStyles:!1,domClasses:["pageconsole-window","pageconsole-input","pageconsole-output"],stdOut:"pageconsole",hideOnExecCommand:!1,greeting:document.title||"Welcome!",maxOutputLines:5,outputTextColor:"white",position:"left"},Pageconsole.prototype.man=function(a){var b;if(0===a.length){this._commandsList.sort(),b=this._config.maxOutputLines,this._config.maxOutputLines=this._commandsList.length;for(var c=0;c<this._commandsList.length;c++)this.print(this._commandsList[c]);this._config.maxOutputLines=b}else if(this[a[0]].man){var d=this[a[0]].man.split("\n");b=this._config.maxOutputLines,this._config.maxOutputLines=d.length;for(var c=0;c<d.length;c++)this.print(d[c]);this._config.maxOutputLines=b}else this.print("No manual for this command.")},Pageconsole.prototype.alias=function(a){var b=a.shift();this._aliasses[b]=a.join(" "),window.localStorage.setItem("aliasses",JSON.stringify(this._aliasses))},Pageconsole.prototype.alias.man="[1;32]Aliasses 1.0[0;37]\nProgram saves an alias to specific command.\nex.: [1;33]alias st scroll top\nst[0;37] is an alias for command [1;33]scroll top[0;37]",Pageconsole.prototype.exit=function(){this.hide(),this.clear()},Pageconsole.prototype.say=function(a){"undefined"!=typeof artyom?artyom.speechSupported?(a=a instanceof Array?a:a.split(" "),"selected"===a[0]?(a.shift(),console.log(this._actualNode),artyom.say(this._actualNode.parentNode.innerText)):artyom.say(a.join(" "))):this.print("Speech synthesis is not supported in your browser."):this.print("Artyom is not defined")},Pageconsole.prototype.say.man="[1;32]Say It 1.0[0;37]\nProgram TextToSpeech.\nOptions:\n-[1;33]say [text]\n-[1;33]say selected (after select command)",Pageconsole.prototype.shutup=function(){"undefined"!=typeof artyom?artyom.speechSupported?artyom.shutUp():this.print("Speech synthesis is not supported in your browser."):this.print("Artyom is not defined")},Pageconsole.prototype.shutup.man="[1;32]Shut Up[0;37]\nCommand stops reading text.",Pageconsole.prototype.scroll=function(a){function b(a,b){var c=0,d=a/(b/15);d=Math.floor(d),console.log(d);var e=setInterval(function(){window.scrollBy(0,d),c+=Math.abs(d),c>=Math.abs(a)&&clearInterval(e)},15)}var c="undefined"==typeof a[1]?500:a[1];if(0===a.length)b(c,500);else switch(a[0].toLowerCase()){case"down":b(c,500);break;case"up":b(-c,500);break;case"top":window.scrollTo(0,0);break;case"bottom":window.scrollTo(0,document.body.scrollHeight)}},Pageconsole.prototype.scroll.man="[1;32]Scrolling 1.0[0;37]\nOptions:\n-[1;33]down\n-[1;33]down [int]\n-[1;33]up\n-[1;33]up [int]\n-[1;33]top\n-[1;33]bottom",Pageconsole.prototype.select=function(a){function b(a){var b=0;if(a.offsetParent){do b+=a.offsetTop;while(a=a.offsetParent);return[b]}}for(;;){if(0===a.length||"next"===a[0]?this._actualNode=this._walk.nextNode():"prev"===a[0]&&(this._actualNode=this._walk.previousNode()),null===this._actualNode){this._actualNode=this._prevNode;break}if(-1!==this._selectablesElems.indexOf(this._actualNode.parentNode.nodeName)&&this._actualNode.parentNode.clientHeight>0&&this._actualNode.parentNode.clientWidth>0)break}this._prevNode.parentNode.style.border="",this._actualNode.parentNode.style.border="2px solid red",window.scrollTo(0,b(this._actualNode.parentNode)-60),this._prevNode=this._actualNode},Pageconsole.prototype.select.man="[1;32]Select element[0;37]\nOptions:\n-[1;33]next\n-[1;33]prev",Pageconsole.prototype.www=function(a){var b=document.createElement("iframe"),c=document.createElement("div"),d=function(a){document.body.removeChild(b),document.body.removeChild(c),this.print("Bye...")},e="";a[0]?(e=/^(http|https):\/\//.test(a[0])?a[0]:"http://"+a[0],b.src=e,b.style.position="fixed",b.style.top="20px",b.style.left="20px",b.style.width="90%",b.style.height="90%",b.style.transform="translate(5%,5%)",b.style.zIndex="9999",b.style.background="#fff",c.style.position="fixed",c.style.top="0px",c.style.left="0px",c.style.width="100%",c.style.height="100%",c.style.zIndex="9998",c.style.background="rgba(255,255,255,.85)",document.body.appendChild(b),document.body.appendChild(c),this.print("Press ENTER to exit"),this.getLine(d.bind(this))):this.print("Enter a website URL")},Pageconsole.prototype.www.man="[1;32]Change website[0;37]\n";